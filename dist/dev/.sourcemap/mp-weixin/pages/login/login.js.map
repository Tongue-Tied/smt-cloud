{"version":3,"sources":["uni-app:///src/main.js","webpack:///./src/pages/login/login.vue?588e","webpack:///./src/pages/login/login.vue?3d0f","webpack:///./src/pages/login/login.vue?1f19","webpack:///./src/pages/login/login.vue?799f","uni-app:///src/pages/login/login.vue","webpack:///./src/pages/login/login.vue?bd36"],"names":["createPage","Page","component","renderjs","options","__file","components","uTabs","uField","uIcon","uInput","uButton","uVerificationCode","e","message","indexOf","console","error","render","_vm","this","_h","$createElement","_self","_c","_isMounted","e0","$event","selectShow","recyclableRender","staticRenderFns","_withStripped","log","url","title","phone","type"],"mappings":"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","file":"pages/login/login.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\nimport Vue from 'vue'\nimport Page from './pages/login/login.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./login.vue?vue&type=template&id=b237504c&\"\nvar renderjs\nimport script from \"./login.vue?vue&type=script&lang=js&\"\nexport * from \"./login.vue?vue&type=script&lang=js&\"\nimport style0 from \"./login.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/login/login.vue\"\nexport default component.exports","export * from \"-!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=template&id=b237504c&\"","var components\ntry {\n  components = {\n    uTabs: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-tabs/u-tabs\" */ \"uview-ui/components/u-tabs/u-tabs.vue\"\n      )\n    },\n    uField: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-field/u-field\" */ \"uview-ui/components/u-field/u-field.vue\"\n      )\n    },\n    uIcon: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-icon/u-icon\" */ \"uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n    uInput: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-input/u-input\" */ \"uview-ui/components/u-input/u-input.vue\"\n      )\n    },\n    uButton: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-button/u-button\" */ \"uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    uVerificationCode: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-verification-code/u-verification-code\" */ \"uview-ui/components/u-verification-code/u-verification-code.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  if (!_vm._isMounted) {\n    _vm.e0 = function($event) {\n      _vm.selectShow = !_vm.selectShow\n    }\n  }\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=script&lang=js&\"","<template>\r\n    <div class=\"login-panel\">\r\n        <!-- <m-navbar></m-navbar> -->\r\n        <div class=\"login_head\">\r\n            <div class=\"login_logo\">\r\n                <image :src=\"logoImage\" alt=\"\" />\r\n            </div>\r\n            <div class=\"login_title\">弱视训练宝</div>\r\n            <div class=\"login_sub\">Amblyopia Training</div>\r\n        </div>\r\n        <u-tabs\r\n            :list=\"list\"\r\n            active-color=\"rgb(255, 39, 66)\"\r\n            bar-width=\"180\"\r\n            :is-scroll=\"false\"\r\n            :current=\"current\"\r\n            @change=\"change\"\r\n        ></u-tabs>\r\n\r\n        <div v-show=\"current === 0\">\r\n            <u-field\r\n                v-model=\"form.phone\"\r\n                label-width=\"0\"\r\n                type=\"number\"\r\n                class=\"my_input\"\r\n                icon=\"account\"\r\n                placeholder=\"请输入手机号/用户名\"\r\n            >\r\n            </u-field>\r\n            <div>\r\n                <u-field\r\n                    v-model=\"form.password\"\r\n                    class=\"my_input\"\r\n                    label-width=\"0\"\r\n                    type=\"password\"\r\n                    icon=\"lock\"\r\n                    placeholder=\"请输入密码\"\r\n                >\r\n                </u-field>\r\n            </div>\r\n        </div>\r\n        <div v-show=\"current === 1\">\r\n            <!-- <div style=\"padding:0;background:black\">\r\n                <minput></minput>\r\n            </div> -->\r\n            <div class=\"code_input\">\r\n                <div class=\"type_icon\">\r\n                    <u-icon name=\"phone\"></u-icon>\r\n                    <div class=\"type_box\" @click=\"selectShow = !selectShow\">\r\n                        <span class=\"type_num\">+{{myValue}}</span>\r\n                        <u-icon name=\"arrow-down-fill\" color=\"#DDDFE0\" size=\"16\"></u-icon>\r\n                    </div>\r\n                    <div class=\"fixed_box\" v-if=\"selectShow\">\r\n                        <div class=\"s_item\" @click=\"cellClick(index,item)\"\r\n                                            v-for=\"(item, index) in typeList\"\r\n                                            :key=\"index\">\r\n                            <span :style=\"!item.checked || 'color:#ff2724'\">{{item.name}}</span>\r\n                            <u-icon v-if=\"item.checked\" color=\"#ff2724\" size=\"30\" name=\"checkbox-mark\"></u-icon>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <u-input placeholder-style=\"color:grey\" v-model=\"form.phone\" type=\"number\" placeholder=\"请输入手机号\"  />\r\n            </div>\r\n            <div>\r\n                <div style=\"position:relative\">\r\n                    <u-field\r\n                        v-model=\"form.code\"\r\n                        class=\"my_input u-flex-1\"\r\n                        label-width=\"0\"\r\n                        type=\"number\"\r\n                        :border-bottom=\"false\"\r\n                        icon=\"lock\"\r\n                        :clearable=\"false\"\r\n                        placeholder=\"请输入验证码\"\r\n                    ></u-field>\r\n                    <div class=\"code_box\">\r\n                        <u-button\r\n                        type=\"primary\"\r\n                        size=\"medium\"\r\n                        @click=\"getCode\"\r\n                        >{{ tips }}</u-button\r\n                    >\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <u-verification-code\r\n                :seconds=\"seconds\"\r\n                ref=\"uCode\"\r\n                @change=\"codeChange\">\r\n            </u-verification-code>\r\n        </div>\r\n        <u-button\r\n            type=\"primary\"\r\n            style=\"margin-top:20rpx;font-size:15px\"\r\n            size=\"large\"\r\n            @click=\"loginClick\"\r\n            :loading=\"loading\"\r\n            >登录</u-button\r\n        >\r\n        <div class=\"forget_box\">\r\n            <div class=\"forget\" @click=\"toForget\">忘记密码</div>\r\n            <div class=\"register\">\r\n                <span>我是新用户，</span><span @click=\"toRegister\">去注册</span>\r\n            </div>\r\n        </div>\r\n        <div class=\"wechat_icon\">\r\n            <label for=\"\" @tap=\"getUserProfile\">\r\n                <u-icon color=\"#51AA38\" name=\"weixin-circle-fill\" size=\"50\"></u-icon>\r\n                <div>微信授权登录</div>\r\n            </label>\r\n        </div>\r\n    </div>\r\n</template>\r\n<script>\r\nimport apiLogin from '@/services/api.login.js';\r\nexport default {\r\n    name: 'login',\r\n    mixins: [],\r\n    props: {},\r\n    components: { },\r\n    computed: {},\r\n    data() {\r\n        return {\r\n            url: undefined,\r\n            loading: false,\r\n            loginType: 1,\r\n            tips: '获取验证码',\r\n            seconds: 60,\r\n            passwordImg: '',\r\n            codeImg: '',\r\n            forgetImg: '',\r\n            roleVisible: false,\r\n            form: {\r\n                phone: '',\r\n                password: '',\r\n                code: ''\r\n            },\r\n            list: [\r\n                {\r\n                    name: '账号密码登录'\r\n                },\r\n                {\r\n                    name: '短信快捷登录'\r\n                }\r\n            ],\r\n            current: 0,\r\n            roles: [],\r\n            checkRole: undefined,\r\n            logoImage: require('@/static/imgs/login/logo.png'),\r\n            typeList: [\r\n                {\r\n                    value: 86,\r\n                    name: '中国大陆+86',\r\n                    checked: true\r\n                },\r\n                {\r\n                    value: 852,\r\n                    name: '中国香港+852',\r\n                    checked: false\r\n                },\r\n                {\r\n                    value: 853,\r\n                    name: '中国澳门+853',\r\n                    checked: false\r\n                },\r\n                {\r\n                    value: 886,\r\n                    name: '中国台湾+886',\r\n                    checked: false\r\n                }\r\n            ],\r\n            selectShow: false,\r\n            myValue: 86\r\n        };\r\n    },\r\n    onLoad(options) {\r\n    },\r\n    created() {\r\n        // this.weChatLogin();\r\n    },\r\n    onShow() {\r\n        if (uni.getStorageSync('token')) {\r\n            return uni.switchTab({\r\n                url: '/pages/index/index'\r\n            });\r\n        }\r\n    },\r\n    methods: {\r\n        change(e) {\r\n            this.current = e;\r\n        },\r\n        toForget() {\r\n            uni.navigateTo({ url: '/pages/mine/views/reset-password?fromLogin=1' });\r\n        },\r\n        toRegister() {\r\n            uni.navigateTo({ url: '/pages/login/views/register' });\r\n        },\r\n        cellClick(index, item) {\r\n            console.log(index);\r\n            console.log(item);\r\n            for (let i = 0; i < this.typeList.length; i++) {\r\n                this.typeList[i].checked = false;\r\n            }\r\n            this.typeList[index].checked = !this.typeList[index].checked;\r\n            this.myValue = item.value;\r\n            this.selectShow = false;\r\n        },\r\n        async loginClick() {\r\n            const msg = this.verify();\r\n            if (msg) {\r\n                this.$toast(msg);\r\n                return;\r\n            }\r\n            this.go();\r\n        },\r\n        weChatLogin(userInfo) {\r\n            // eslint-disable-next-line no-undef\r\n            let weixin = wx;\r\n            let that = this;\r\n            that.$loading.close();\r\n            weixin.login({\r\n                success: function(res) {\r\n                    // var that = this;\r\n                    // var header = {\r\n                    //     'content-type': 'application/x-www-form-urlencoded'\r\n                    // };\r\n                    if (res.code) {\r\n                        console.log(res.code);\r\n                        apiLogin.wxLogin({ code: res.code }).then(\r\n                            res => {\r\n                                if (res.code === 1) {\r\n                                    that.$store.commit('updateToken', res.retObj);\r\n                                    if (!res.retObj.userNick && !res.retObj.headImg) {\r\n                                        let data = {\r\n                                            headImg: userInfo.avatarUrl,\r\n                                            userNick: userInfo.nickName\r\n                                        };\r\n                                        apiLogin.updateUserInfo(data).then(\r\n                                            res => {\r\n                                                that.$store.dispatch('loadUser');\r\n                                                uni.switchTab({\r\n                                                    url: '/pages/index/index'\r\n                                                });\r\n                                                that.$loading.close();\r\n                                                console.log(res);\r\n                                            }\r\n                                        );\r\n                                    } else if (!res.retObj.phone) {\r\n                                        that.$loading.close();\r\n                                        console.log(111);\r\n                                        // that.$store.dispatch('loadUser');\r\n                                        uni.reLaunch({ url: '/pages/mine/views/update-phone' });\r\n                                    } else {\r\n                                        that.$loading.close();\r\n                                        that.$store.dispatch('loadUser');\r\n                                        uni.switchTab({\r\n                                            url: '/pages/index/index'\r\n                                        });\r\n                                    }\r\n                                }\r\n                                // let data = {\r\n                                //     t: 2,\r\n                                //     userName: userInfo.nickName,\r\n                                //     openId: res.retObj.xcxOpenid\r\n                                // };\r\n                                // apiLogin.getBindWxOpenid(data).then(\r\n                                //     res => {\r\n                                //         console.log(res);\r\n                                //     }\r\n                                // );\r\n                                console.log(res);\r\n                            }\r\n                        );\r\n                        // weixin.request({ // getOpenid\r\n                        //     url: 'https://api.weixin.qq.com/sns/jscode2session',\r\n                        //     data: {\r\n                        //         appid: 'wx6db2e40f820b9c1d', // AppID\r\n                        //         secret: '9155061a9b16cd4d4ff6564c15f36fad', // secret密钥\r\n                        //         grant_type: 'authorization_code',\r\n                        //         js_code: res.code\r\n                        //     },\r\n                        //     method: 'GET',\r\n                        //     header: header,\r\n                        //     success: function(res) {\r\n                        //         var openid = res.data.openid;// 登录之后返回的openid\r\n                        //         // this.setData({\r\n                        //         //   openid: res.data.openid\r\n                        //         // });\r\n                        //         that.$loading.open();\r\n                        //         let data = {\r\n                        //             type: 1,\r\n                        //             t: 2,\r\n                        //             openid: openid\r\n                        //         };\r\n                        //         apiLogin.threeLogin(data).then(\r\n                        //             res => {\r\n                        //                 if (res.code === 1) {\r\n                        //                     that.$store.commit('updateToken', res.retObj);\r\n                        //                     that.$store.dispatch('loadUser');\r\n                        //                     uni.switchTab({\r\n                        //                         url: '/pages/index/index'\r\n                        //                     });\r\n                        //                     that.$loading.close();\r\n                        //                 }\r\n                        //             },\r\n                        //             err => {\r\n                        //                 that.$toast(err.msg);\r\n                        //                 that.$loading.close();\r\n                        //             }\r\n                        //         );\r\n                        //         // console.log(openid + '我的openid');\r\n                        //         weixin.setStorageSync('openid', openid);// 储存openid\r\n                        //     },\r\n                        //     fail: function(res) {\r\n                        //         console.info('获取用户openid失败');\r\n                        //         // console.log(error);\r\n                        //     }\r\n                        // });\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        async go() {\r\n            // 登录\r\n            const data = {\r\n                phone: this.form.phone\r\n            };\r\n            if (this.current === 0) {\r\n                data.pwd = this.form.password;\r\n            } else {\r\n                data.code = this.form.code;\r\n            }\r\n            this.loading = true;\r\n            try {\r\n                var res = await apiLogin.auth(data);\r\n            } catch (e) {\r\n                console.log(e);\r\n            }\r\n            if (res.code === 1 && res.msg !== '未设置密码') {\r\n                this.$store.commit('updateToken', res.retObj);\r\n                this.$store.dispatch('loadUser');\r\n                uni.switchTab({\r\n                    url: '/pages/index/index'\r\n                });\r\n            } else if (res.code === 1 && res.msg === '未设置密码') {\r\n                uni.navigateTo({ url: '/pages/mine/views/set-password' });\r\n            }\r\n            this.loading = false;\r\n            this.$toast(res.msg);\r\n            return;\r\n        },\r\n        // async login() {\r\n        //     this.$loading.open();\r\n        //     try {\r\n        //         await apiLogin.bindUser(this.checkRole.id);\r\n        //     } catch (e) {\r\n        //         console.error(e);\r\n        //         this.$loading.close();\r\n        //         this.$toast(e.message || '登录失败，请稍后再试');\r\n        //         return;\r\n        //     }\r\n        //     this.roleVisible = false;\r\n        //     await this.$store.dispatch('loadUser', true);\r\n        //     this.$loading.close();\r\n        //     if (this.url) {\r\n        //         uni.redirectTo({\r\n        //             url: decodeURIComponent(this.url)\r\n        //         });\r\n        //     } else {\r\n        //         this.$store.commit('updateBackFlag', true);\r\n        //         // #ifdef H5\r\n        //         uni.reLaunch({ url: '/pages/index/index' });\r\n        //         // #endif\r\n        //         // #ifndef H5\r\n        //         uni.navigateBack();\r\n        //         // #endif\r\n        //     }\r\n        // },\r\n        // checkRes(res, showMsg) {\r\n        //     // 处理返回结果\r\n        //     const data = res.data;\r\n        //     if (data.type == 2 || data.type == 3) {\r\n        //         if (this.loginType == 1) {\r\n        //             this.passwordImg = data.value;\r\n        //         } else if (this.loginType == 2) {\r\n        //             this.codeImg = data.value;\r\n        //         } else if (this.loginType == 3) {\r\n        //             this.forgetImg = data.value;\r\n        //         }\r\n        //         if (showMsg) {\r\n        //             if (data.type == 2) {\r\n        //                 this.$toast('请输入图形验证码');\r\n        //             } else if (data.type == 3) {\r\n        //                 this.$toast('图形验证码错误');\r\n        //             }\r\n        //         } else {\r\n        //             this.$loading.close();\r\n        //         }\r\n        //         this.form.authPhoneCaptchaDetailId =\r\n        //             data.authPhoneCaptchaDetailId;\r\n        //         return true;\r\n        //     } else if (data.type == 4) {\r\n        //         this.$loading.close();\r\n        //         return true;\r\n        //     }\r\n        //     this.passwordImg = '';\r\n        //     this.codeImg = '';\r\n        //     this.forgetImg = '';\r\n        //     this.form.authPhoneCaptchaDetailId = '';\r\n        //     this.$loading.close();\r\n        // },\r\n        // roleClick(item) {\r\n        //     this.checkRole = item;\r\n        // },\r\n        // codeChange(text) {\r\n        //     this.tips = text;\r\n        // },\r\n        async getCode() {\r\n            if (this.form.phone === '') {\r\n                return this.$toast('请输入正确的手机号');\r\n            }\r\n            if (this.$refs.uCode.canGetCode) {\r\n                // 模拟向后端请求验证码\r\n                uni.showLoading({\r\n                    title: '正在获取验证码'\r\n                });\r\n                let data = {\r\n                    phone: this.form.phone,\r\n                    type: this.myValue\r\n                };\r\n                apiLogin.sendCode(data, true).then(\r\n                    res => {\r\n                        if (res.code === 1) {\r\n                            uni.hideLoading();\r\n                            // 通知验证码组件内部开始倒计时\r\n                            this.$refs.uCode.start();\r\n                        } else {\r\n                            uni.hideLoading();\r\n                            this.$toast('获取验证码失败');\r\n                            this.$refs.uCode.reset();\r\n                        }\r\n                        console.log(res);\r\n                    }\r\n                );\r\n            } else {\r\n                this.$u.toast('倒计时结束后再发送');\r\n            }\r\n        },\r\n        async savePassword() {\r\n            const msg = this.verify();\r\n            if (msg) {\r\n                this.$toast(msg);\r\n                return;\r\n            }\r\n            // 修改密码\r\n            const data = {\r\n                userName: this.form.phone,\r\n                password: this.base64(this.form.newPassword),\r\n                captcha: this.form.forgetCode\r\n            };\r\n            this.loading = true;\r\n            try {\r\n                var res = await apiLogin.updatePassword(data);\r\n            } catch (e) {\r\n                this.loading = false;\r\n                if (e.message) {\r\n                    this.$toast(e.message);\r\n                }\r\n                return;\r\n            }\r\n            if (this.checkRes(res, true)) {\r\n                this.loading = false;\r\n                return;\r\n            }\r\n            this.$toast('密码修改成功，请使用新密码登录');\r\n            this.changeType(1);\r\n            this.$store.commit('signout');\r\n            this.form.forgetCode = '';\r\n            this.form.newPassword = '';\r\n            this.form.newPassword2 = '';\r\n            this.form.password = '';\r\n            this.loading = false;\r\n        },\r\n        dataFormat() {\r\n            // const data = {\r\n            //     phone: this.form.phone,\r\n            //     purpose: 1,\r\n            //     merchantId: -1,\r\n            //     shapedCode: this.form.codeImgValue,\r\n            //     yzType: 0,\r\n            //     authPhoneCaptchaDetailId: this.form.authPhoneCaptchaDetailId\r\n            // };\r\n            // if (this.loginType == 3) {\r\n            //     data.shapedCode = this.form.forgetImgValue;\r\n            // }\r\n            // return data;\r\n        },\r\n        verify() {\r\n            if (!this.$u.test.mobile(this.form.phone)) {\r\n                return '请输入正确的手机号';\r\n            }\r\n            if (this.loginType == 1) {\r\n                if (!this.form.password) {\r\n                    return '请输入密码';\r\n                }\r\n            } else if (this.loginType == 2) {\r\n                if (!this.form.code) {\r\n                    return '请输入验证码';\r\n                }\r\n            } else if (this.loginType == 3) {\r\n                if (!this.form.forgetCode) {\r\n                    return '请输入验证码';\r\n                }\r\n                if (!this.form.newPassword) {\r\n                    return '请输入密码';\r\n                }\r\n                if (this.form.newPassword.length < 6) {\r\n                    return '密码至少6位';\r\n                }\r\n                if (this.form.newPassword != this.form.newPassword2) {\r\n                    return '新密码两次输入不一致';\r\n                }\r\n            }\r\n        },\r\n        changeType(type) {\r\n            this.loginType = type;\r\n            let title = '';\r\n            switch (type) {\r\n                case 1:\r\n                    title = '登录';\r\n                    break;\r\n                case 2:\r\n                    title = '验证码登录';\r\n                    break;\r\n                case 3:\r\n                    title = '忘记密码';\r\n                    break;\r\n                default:\r\n                    break;\r\n            }\r\n            uni.setNavigationBarTitle({ title });\r\n        },\r\n        call() {\r\n            uni.makePhoneCall({\r\n                phoneNumber: '400-006-2020'\r\n            });\r\n        },\r\n        getUserProfile() {\r\n            // #if MP-WEIXIN\r\n        // uni.navigateTo({ url: '/pages/demo/demo' });\r\n            // eslint-disable-next-line no-undef\r\n            let weixin = wx;\r\n            console.log(weixin);\r\n            let that = this;\r\n            weixin.getUserProfile({\r\n                desc: '获取你的昵称、头像、地区及性别',\r\n                success: function(res) {\r\n                    console.log(res);\r\n                    // let userInfo = res.userInfo;\r\n                    that.weChatLogin(res.userInfo);\r\n                },\r\n                fail: function(res) {\r\n                    that.$toast('微信授权失败');\r\n                }\r\n            });\r\n            // eslint-disable-next-line no-undef\r\n            // eslint-disable-next-line no-undef\r\n        // let that = this;\r\n        // weixin.getUserInfo({\r\n        //     desc: '用于完善会员资料', // 声明获取用户个人信息后的用途，后续会展示在弹窗中，请谨慎填写\r\n        //     success: (res) => {\r\n        //         console.log(res);\r\n        //         // let userInfo = res.userInfo;\r\n        //         // uni.setStorageSync('weChatUserInfo', res.userInfo);\r\n        //         // weixin.cloud.callFunction({\r\n        //         //     name: 'getOpenId'\r\n        //         // }).then(\r\n        //         //     res => {\r\n        //         //         // uni.setStorageSync('openId', res.result.openid);\r\n        //         //         // let myData = {\r\n        //         //         //     openId: res.result.openid,\r\n        //         //         //     t: 2,\r\n        //         //         //     userName: userInfo.nickName\r\n        //         //         // };\r\n        //         //         // apiLogin.getBindWxOpenid(myData).then(\r\n        //         //         //     res => {\r\n        //         //         //         if (res.code === 2) {\r\n        //         //         //             that.$toast('账号已被绑定');\r\n        //         //         //             return;\r\n        //         //         //         } else {\r\n        //         //         //             that.go();\r\n        //         //         //         }\r\n        //         //         //     },\r\n        //         //         //     err => {\r\n        //         //         //         that.$toast('账号已被绑定');\r\n        //         //         //         return;\r\n        //         //         //     }\r\n        //         //         // );\r\n        //         //     }\r\n        //         // );\r\n        //     }\r\n        // });\r\n        // eslint-disable-next-line no-undef\r\n        // console.log(wx.cloud.CloudID());\r\n        // eslint-disable-next-line no-undef\r\n        // wx.cloud.callFunction({\r\n        //     name: 'message'\r\n        // }).then(console.log);\r\n        // #endif\r\n        },\r\n        base64(str) {\r\n            var base64EncodeChars =\r\n                'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\r\n            var out, i, len;\r\n            var c1, c2, c3;\r\n            len = str.length;\r\n            i = 0;\r\n            out = '';\r\n            while (i < len) {\r\n                c1 = str.charCodeAt(i++) & 0xff;\r\n                if (i === len) {\r\n                    out += base64EncodeChars.charAt(c1 >> 2);\r\n                    out += base64EncodeChars.charAt((c1 & 0x3) << 4);\r\n                    out += '==';\r\n                    break;\r\n                }\r\n                c2 = str.charCodeAt(i++);\r\n                if (i === len) {\r\n                    out += base64EncodeChars.charAt(c1 >> 2);\r\n                    out += base64EncodeChars.charAt(\r\n                        ((c1 & 0x3) << 4) | ((c2 & 0xf0) >> 4)\r\n                    );\r\n                    out += base64EncodeChars.charAt((c2 & 0xf) << 2);\r\n                    out += '=';\r\n                    break;\r\n                }\r\n                c3 = str.charCodeAt(i++);\r\n                out += base64EncodeChars.charAt(c1 >> 2);\r\n                out += base64EncodeChars.charAt(\r\n                    ((c1 & 0x3) << 4) | ((c2 & 0xf0) >> 4)\r\n                );\r\n                out += base64EncodeChars.charAt(\r\n                    ((c2 & 0xf) << 2) | ((c3 & 0xc0) >> 6)\r\n                );\r\n                out += base64EncodeChars.charAt(c3 & 0x3f);\r\n            }\r\n            return out;\r\n        },\r\n        codeChange(text) {\r\n            this.tips = text;\r\n        }\r\n    }\r\n};\r\n</script>\r\n<style lang=\"less\">\r\npage {\r\n    background-color: white;\r\n}\r\n.login-panel {\r\n    // padding-top: 300rpx;\r\n    min-height: calc(100vh - var(--window-top));\r\n    background-color: white;\r\n    .login_head {\r\n        text-align: center;\r\n        padding-bottom: 100rpx;\r\n        .login_logo {\r\n            width: 130rpx;\r\n            height: 130rpx;\r\n            margin: 0 auto;\r\n            image {\r\n                width: 100%;\r\n                height: 100%;\r\n            }\r\n        }\r\n        .login_title {\r\n            font-size: 15px;\r\n            font-weight: bold;\r\n            font-family: Source Han Sans CN;\r\n        }\r\n        .login_sub {\r\n            font-size: 12px;\r\n            color: #333333;\r\n        }\r\n    }\r\n    .wechat_icon{\r\n        padding-top: 40rpx;\r\n        display: flex;\r\n        justify-content: center;\r\n        width: 100%;\r\n        text-align: center;\r\n        color: #333333;\r\n        // font-size: 24rpx;\r\n    }\r\n    .my_input {\r\n        width: 570rpx;\r\n        margin: 0 auto;\r\n        border-radius: 60rpx;\r\n        // padding: 10rpx;\r\n        margin-top: 10rpx;\r\n        background: #f5f5f5;\r\n        margin-top: 20rpx;\r\n        .u-field{\r\n            width: 610rpx;\r\n            margin: 20rpx auto;\r\n            background: #f5f5f5;\r\n            border-radius: 60rpx;\r\n            position: unset;\r\n        }\r\n    }\r\n    .u-border,\r\n    .u-border-bottom,\r\n    .u-border-left,\r\n    .u-border-right,\r\n    .u-border-top,\r\n    .u-border-top-bottom {\r\n        position: unset;\r\n    }\r\n    .login-logo {\r\n        width: 280rpx;\r\n        margin: 0 auto;\r\n        .ll-img {\r\n            width: 100%;\r\n        }\r\n    }\r\n    input {\r\n        font-size: 28rpx;\r\n    }\r\n    .code_box{\r\n        position: absolute;\r\n        right: 240rpx;\r\n        top: 50%;\r\n        transform: translate(0,-50%);\r\n        width: 60rpx;\r\n        z-index: 1000;\r\n        button{\r\n            width: auto;\r\n            height: 56rpx !important;\r\n            padding: 0 20rpx;\r\n        }\r\n    }\r\n    .forget_box{\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: space-between;\r\n        width: 570rpx;\r\n        margin: 0 auto;\r\n        padding-top: 20rpx;\r\n        .forget{\r\n            font-size: 24rpx;\r\n        }\r\n        .register{\r\n            span{\r\n                font-size: 24rpx;\r\n            }\r\n            :nth-child(2){\r\n                color: #ff2724;\r\n                border-bottom:2rpx solid #ff2724;\r\n                padding-bottom: 2rpx;\r\n            }\r\n        }\r\n    }\r\n    .code_input{\r\n        position: relative;\r\n        width: 610rpx;\r\n        margin: 0 auto;\r\n        border-radius: 60rpx;\r\n        // padding: 10rpx;\r\n        margin-top: 10rpx;\r\n        background: #f5f5f5;\r\n        margin-top: 20rpx;\r\n        font-size: 28rpx;\r\n        padding: 20rpx 28rpx;\r\n        text-align: left;\r\n        position: relative;\r\n        color: #5c636a;\r\n        display: flex;\r\n        align-items: center;\r\n        .type_icon{\r\n            // position: absolute;\r\n            // left: 30rpx;\r\n            // top: 50%;\r\n            // transform: translate(0,-50%);\r\n            height: 30rpx;\r\n            display: flex;\r\n            align-items: center;\r\n            position: relative;\r\n            .type_box{\r\n                padding: 0 10rpx;\r\n            }\r\n            .fixed_box{\r\n                position: absolute;\r\n                width: 300rpx;\r\n                top: 50rpx;\r\n                left: 30rpx;\r\n                background: #ffffff;\r\n                transition-duration: 0.2s;\r\n                box-shadow: 0 0 70rpx 5rpx #eeeeee;\r\n                z-index: 1000000;\r\n                padding: 0 30rpx;\r\n                .s_item{\r\n                    display: flex;\r\n                    height: 100rpx;\r\n                    align-items: center;\r\n                    justify-content: space-between;\r\n                    border-bottom: 2rpx solid #eeeeee;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./login.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}
{"version":3,"sources":["uni-app:///src/main.js","webpack:///./src/pages/shopping-car/shopping-car.vue?8adc","webpack:///./src/pages/shopping-car/shopping-car.vue?f41a","webpack:///./src/pages/shopping-car/shopping-car.vue?a683","webpack:///./src/pages/shopping-car/shopping-car.vue?16de","uni-app:///src/pages/shopping-car/shopping-car.vue","webpack:///./src/pages/shopping-car/shopping-car.vue?f38a"],"names":["createPage","Page","component","renderjs","options","__file","components","uCheckbox","uNumberBox","uEmpty","e","message","indexOf","console","error","render","_h","this","$createElement","_self","_c","recyclableRender","staticRenderFns","_withStripped","res","retArr","i","isChose"],"mappings":";;;;wEAAA,qBAAmB,8BACnB,kB,mDAEAA,EADA,sDACWC,U;;;;2DCHX,6ZASIC,EAAY,kBACd,UACA,SACA,mBACA,EACA,KACA,KACA,MACA,EACA,kBAjBEC,GAqBJD,EAAUE,QAAQC,OAAS,sCACZ,UAAAH,E;;;;2GCvBf,+0B;;;;2GCAA,IAAII,EAAJ,kLACA,IACEA,EAAa,CACXC,UAAW,WACT,OAAO,kNAITC,WAAY,WACV,OAAO,8NAITC,OAAQ,WACN,OAAO,iMAKX,MAAOC,GACP,IAC+C,IAA7CA,EAAEC,QAAQC,QAAQ,wBACa,IAA/BF,EAAEC,QAAQC,QAAQ,QAWlB,MAAMF,EATNG,QAAQC,MAAMJ,EAAEC,SAChBE,QAAQC,MAAM,mBACdD,QAAQC,MACN,uFAEFD,QAAQC,MACN,mDAMN,IAAIC,EAAS,WACX,IACIC,EADMC,KACGC,eADHD,KAEGE,MAAMC,IAEjBC,GAAmB,EACnBC,EAAkB,GACtBP,EAAOQ,eAAgB,G;;;;2DC3CvB,0jBAA4f,YAAG,G;;;;4OCkD/f,yC,kLACA,CACE,KADF,WAEI,MAAJ,CACM,QAAN,GACM,SAAN,EACM,WAAN,EACM,iBAAN,EACM,SAAN,IAGE,QAVF,WAWI,KAAJ,WAEE,QAAF,CACI,QADJ,WACM,I,EAAN,OAAM,O,EAAN,4BAAQ,IAAR,IAAQ,OAAR,wFAGA,oBAHA,OAGgBC,EAHhB,6DAOA,MACA,8BACoBA,EAAIC,OAAOC,GAAGC,SAAU,EAE5C,mBACA,qBACoB,EAApB,WAEoB,EAApB,WAEA,eACA,qBACA,oDAnBA,qD,2KAAA,IAsBI,SAvBJ,WAwBM,GAAN,aACQ,IAAR,kCACU,KAAV,sBACU,KAAV,aACU,KAAV,wBAGQ,IAAR,kCACU,KAAV,sBACU,KAAV,mHACU,KAAV,oIAII,WAtCJ,SAsCA,GACM,IAAN,gCAAQ,OAAR,gBACM,QAAN,OAIQ,KAAR,UAHA,EAKA,WAIQ,KAAR,WACQ,KAAR,yFACQ,KAAR,2GALQ,KAAR,uFACQ,KAAR,wGAMM,KAAN,gBAEI,MAxDJ,WAyDM,GAAN,oBACQ,OAAR,wBAGM,IADA,IAAN,KACA,8BACA,0BACU,QAAV,qBACU,EAAV,MACY,UAAZ,CACc,MAAd,2BAEY,SAAZ,mBAIM,EAAN,0BAOM,EAAN,YAAQ,IAAR,yCAEI,UAjFJ,SAiFA,KACA,0BACA,mCACU,KAAV,0FACU,KAAV,4GAEU,KAAV,wFACU,KAAV,0GAGM,KAAN,0BAEI,WA7FJ,WA6FM,IAAN,OACM,GAAN,oBACQ,OAAR,yBAGM,IADA,IAAN,KACA,8BACA,yBACU,EAAV,4BAGM,IAAN,GACQ,OAAR,aAEM,EAAN,uBACA,YACA,YACU,EAAV,cAME,kBAhIF,WAiII,KAAJ,Y;;;;2DCpLA,y5BAAo2B,YAAG,G","file":"pages/shopping-car/shopping-car.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\nimport Vue from 'vue'\nimport Page from './pages/shopping-car/shopping-car.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./shopping-car.vue?vue&type=template&id=37633734&\"\nvar renderjs\nimport script from \"./shopping-car.vue?vue&type=script&lang=js&\"\nexport * from \"./shopping-car.vue?vue&type=script&lang=js&\"\nimport style0 from \"./shopping-car.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/shopping-car/shopping-car.vue\"\nexport default component.exports","export * from \"-!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./shopping-car.vue?vue&type=template&id=37633734&\"","var components\ntry {\n  components = {\n    uCheckbox: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-checkbox/u-checkbox\" */ \"uview-ui/components/u-checkbox/u-checkbox.vue\"\n      )\n    },\n    uNumberBox: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-number-box/u-number-box\" */ \"uview-ui/components/u-number-box/u-number-box.vue\"\n      )\n    },\n    uEmpty: function() {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-empty/u-empty\" */ \"uview-ui/components/u-empty/u-empty.vue\"\n      )\n    }\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./shopping-car.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./shopping-car.vue?vue&type=script&lang=js&\"","<template>\n    <div class=\"shopping_car\">\n        <div class=\"all_chose\" v-if=\"noGoods\">\n            <u-checkbox\n                v-model=\"checked\"\n                shape=\"circle\"\n                @change=\"allChose\"\n            >全选</u-checkbox>\n            <div @click=\"deleteItem\" class=\"delete\">删除</div>\n        </div>\n        <div v-for=\"(item, index) in carList\" :key=\"index\" class=\"car_item\">\n            <div class=\"car_item_checkbox\">\n                <u-checkbox\n                    v-model=\"item.isChose\"\n                    shape=\"circle\"\n                    @change=\"itemChange(item)\"\n                ></u-checkbox>\n            </div>\n            <div class=\"car_item_img\">\n                <image :src=\"item.goodsImg\"></image>\n            </div>\n            <div class=\"car_item_info\">\n                <div class=\"cii_top\">\n                    <div>{{item.goodsName}}</div>\n                    <div>颜色分类: &nbsp;{{item.goodsColor}}</div>\n                    <div>尺码: &nbsp;{{item.goodsSize}}</div>\n                </div>\n                <div class=\"cii_bottom\">\n                    <div class=\"cb_price\">\n                        <span>¥{{item.price}}</span>\n                        <span>¥{{item.origPrice}}</span>\n                    </div>\n                    <div class=\"cb_num\">\n                        <u-number-box :min=\"1\" v-model=\"item.carNumber\" @change=\"valChange(index, $event)\"></u-number-box>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class=\"foot_bar\">\n            <div class=\"fb_price\">\n                <div>合计</div>\n                <div class=\"my_price\"><span>¥{{totalPrice}}</span><span>¥{{totalOriginPrice}}</span></div>\n            </div>\n            <div class=\"fb_btn\" @click=\"toPay\">去支付</div>\n        </div>\n        <u-empty mode=\"car\" margin-top=\"40\" v-if=\"!noGoods\"></u-empty>\n    </div>\n</template>\n\n<script>\nimport apiCar from '@/services/api.shop.js';\nexport default {\n    data() {\n        return {\n            carList: [],\n            checked: false,\n            totalPrice: 0,\n            totalOriginPrice: 0,\n            noGoods: false\n        };\n    },\n    created() {\n        this.getList();\n    },\n    methods: {\n        async getList() {\n            let res;\n            try {\n                res = await apiCar.carList();\n            } catch (e) {\n            // TODO handle the exception\n            }\n            if (res) {\n                for (let i = 0; i < res.retArr.length; i++) {\n                    res.retArr[i].isChose = false;\n                }\n                this.carList = res.retArr;\n                if (this.carList.length === 0) {\n                    this.noGoods = false;\n                } else {\n                    this.noGoods = true;\n                }\n                this.totalPrice = 0;\n                this.totalOriginPrice = 0;\n                setTimeout(function() { uni.stopPullDownRefresh(); }, 100);\n            }\n        },\n        allChose() {\n            if (this.checked) {\n                for (let i = 0; i < this.carList.length; i++) {\n                    this.carList[i].isChose = false;\n                    this.totalPrice = 0;\n                    this.totalOriginPrice = 0;\n                }\n            } else {\n                for (let i = 0; i < this.carList.length; i++) {\n                    this.carList[i].isChose = true;\n                    this.totalPrice = this.$big(this.totalPrice).add(this.carList[i].price * (this.carList[i].count || 1)).toNumber(2).toFixed(2);\n                    this.totalOriginPrice = this.$big(this.totalOriginPrice).add(this.carList[i].origPrice * (this.carList[i].count || 1)).toNumber(2).toFixed(2);\n                }\n            }\n        },\n        itemChange(item) {\n            const found = this.carList.find(e => e.isChose === true);\n            console.log(found);\n            if (!found) {\n                this.checked = false;\n            } else {\n                this.checked = true;\n            }\n            if (!item.isChose) {\n                this.totalPrice = this.$big(this.totalPrice).add(item.price * (item.count || 1)).toNumber(2).toFixed(2);\n                this.totalOriginPrice = this.$big(this.totalOriginPrice).add(item.origPrice * (item.count || 1)).toNumber(2).toFixed(2);\n            } else {\n                this.checked = false;\n                this.totalPrice = this.$big(this.totalPrice).minus(item.price * (item.count || 1)).toNumber(2).toFixed(2);\n                this.totalOriginPrice = this.$big(this.totalOriginPrice).minus(item.origPrice * (item.count || 1)).toNumber(2).toFixed(2);\n            }\n            this.$forceUpdate();\n        },\n        toPay() {\n            if (this.totalPrice === 0) {\n                return this.$toast('还没有选择商品哟');\n            }\n            let arr = [];\n            for (let i = 0; i < this.carList.length; i++) {\n                if (this.carList[i].isChose) {\n                    console.log(this.carList[i]);\n                    arr.push({\n                        goodsInfo: {\n                            title: this.carList[i].goodsName\n                        },\n                        classify: this.carList[i]\n                    });\n                }\n            }\n            uni.setStorageSync('order', arr);\n            // {\n            //             goodsInfo: {\n            //                 title: this.info.title\n            //             },\n            //             classifyList: [this.info.goodsClassifyList[this.classifyActive]]\n            //         }\n            uni.navigateTo({ url: '/pages/index/shop/shop-pay?form=car' });\n        },\n        valChange(index, e) {\n            if (this.carList[index].isChose) {\n                if (e.value - this.carList[index].count === -1) {\n                    this.totalPrice = this.$big(this.totalPrice).minus(this.carList[index].price).toNumber(2).toFixed(2);\n                    this.totalOriginPrice = this.$big(this.totalOriginPrice).minus(this.carList[index].origPrice).toNumber(2).toFixed(2);\n                } else {\n                    this.totalPrice = this.$big(this.totalPrice).add(this.carList[index].price).toNumber(2).toFixed(2);\n                    this.totalOriginPrice = this.$big(this.totalOriginPrice).add(this.carList[index].origPrice).toNumber(2).toFixed(2);\n                }\n            }\n            this.carList[index].count = e.value;\n        },\n        deleteItem() {\n            if (this.totalPrice === 0) {\n                return this.$toast('请选择要删除的商品');\n            }\n            let arr = [];\n            for (let i = 0; i < this.carList.length; i++) {\n                if (this.carList[i].isChose) {\n                    arr.push(this.carList[i].carId);\n                }\n            }\n            let data = {\n                carIds: arr.join(',')\n            };\n            apiCar.delCar(data).then(\n                res => {\n                    if (res.code === 1) {\n                        this.getList();\n                    }\n                }\n            );\n        }\n    },\n    onPullDownRefresh() {\n        this.getList();\n    }\n};\n</script>\n\n<style lang=\"less\">\npage{\n    background: #f5f5f5;\n    padding-bottom: calc(80rpx + env(safe-area-inset-bottom));\n}\n.shopping_car{\n    padding-bottom: 160rpx;\n    .all_chose{\n        width: 92%;\n        margin: 0 auto;\n        padding: 20rpx 0 0 30rpx;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        .delete{\n            padding-right: 20rpx;\n        }\n    }\n    .car_item{\n        display: flex;\n        align-items: center;\n        height: 320rpx;\n        width: 92%;\n        margin: 0 auto;\n        border-radius: 40rpx;\n        background: #ffffff;\n        margin-top: 40rpx;\n        .car_item_checkbox{\n            padding-left: 15rpx;\n        }\n        .car_item_img{\n            width: 160rpx;\n            height: 80%;\n            image{\n                width: 100%;\n                height: 160rpx;\n                border-radius: 20rpx;\n            }\n        }\n        .car_item_info{\n            flex: 1;\n            padding: 0 15rpx 0 30rpx;\n            display: flex;\n            height: 80%;\n            flex-direction: column;\n            justify-content: space-between;\n            .cii_top{\n                display: flex;\n                flex-direction: column;\n                justify-content: flex-start;\n                align-items: flex-start;\n                font-size: 24rpx;\n                color: #999999;\n                :nth-child(1){\n                    font-size: 26rpx;\n                    color: #333333;\n                    padding-bottom: 30rpx;\n                }:nth-child(2){\n                    margin-bottom: 30rpx;\n                }\n            }\n            .cii_bottom{\n                display: flex;\n                justify-content: space-between;\n                .cb_price{\n                    :nth-child(1){\n                        color: #ff2742;\n                        font-size: 30rpx;\n                    }\n                    :nth-child(2){\n                        color: #999999;\n                        font-size: 24rpx;\n                        text-decoration: line-through;\n                        padding-left: 10rpx;\n                    }\n                }\n            }\n        }\n    }\n    .foot_bar{\n        position: fixed;\n        width: 100%;\n        bottom: 0;\n        background: #ffffff;\n        display: flex;\n        align-items: center;\n        justify-content: space-between;\n        padding-bottom: calc(env(safe-area-inset-bottom));\n        padding-top: 40rpx;\n        .fb_price{\n            display: flex;\n            align-items: center;\n            :nth-child(1){\n                font-size: 26rpx;\n                color: #333333;\n                padding-left: 40rpx;\n            }\n            .my_price{\n                :nth-child(1){\n                    color: #ff2742;\n                    font-size: 26rpx;\n                    padding-left: 20rpx;\n                }\n                :nth-child(2){\n                    color: #999999;\n                    font-size: 26rpx;\n                    text-decoration: line-through;\n                    padding-left: 20rpx;\n                }\n            }\n        }\n        .fb_btn{\n            width: 200rpx;\n            height: 60rpx;\n            background: #ff2742;\n            border-radius: 40rpx;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            color: #ffffff;\n            margin-right: 40rpx;\n        }\n    }\n}\n</style>\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./shopping-car.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-3!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--10-oneOf-1-5!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./shopping-car.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}